\begin{tikzpicture}[node distance=2cm, auto, scale=0.9]
\usetikzlibrary{arrows.meta}
% Draw big boxes
\draw[align=center, rounded corners, fill=yellow!20] (0,6) rectangle (24,2.5) {};
\node[draw=none] at (12,5.7145) {\textbf{Mechanical Teacher}};
\draw[align=center, rounded corners, fill=green!20] (1,1.5) rectangle (19,-2) {};
\node[draw=none] at (10,-1.7145) {\textbf{PAC Automata Learning Algorithm (Chapter )}};
% Draw small boxes and diamonds
\node[draw, align=center, rounded corners, fill=blue!20, text width=3.3cm] (a1) at (3,4) {Build and check the path formula of $w$ (Chapter )};
\node[draw, diamond, aspect=3, fill=blue!20, text width=3.3cm, inner sep=0pt, text badly centered] (a2) at (9,4) {$s \in L(B)$?};
\node[draw, diamond, aspect=3, fill=blue!20, text width=3.3cm, inner sep=0pt, text badly centered] (a3) at (15,4) {$\exists s \in S. s \notin L(C)$?};
\node[draw, align=center, rounded corners, fill=blue!20, text width=3.3cm] (a4) at (21,4) {Sample a set $S$ of decision vectors (Chapter )};
\node[draw, align=center, rounded corners, fill=blue!20, text width=3.5cm](b1) at (4,0) {Build/Refine Model (Learning Algorithm)};
\node[draw, diamond, aspect=3, fill=blue!20, text width=3.3cm, inner sep=0pt, text badly centered](b2) at (10,0) {$\exists c. c \in L(C) \cap L(B)$?};
\node[draw, diamond, aspect=3, fill=blue!20, text width=3.3cm, inner sep=0pt, text badly centered](b3) at (16,0) {$c \in \mathsf{decision}(\Pi)$?};
\node[draw, align=center, rounded corners, fill=red!20, text width=3.3cm] (e1) at (3.8,6.8) {$s$ is a feasible error decision vector};
\node[draw, align=center, rounded corners, fill=red!20, text width=3.3cm] (e2) at (22.3773,0) {$c$ is a feasible error decision vector};
\node[draw, align=center, rounded corners, fill=cyan!20, text width=3.3cm] (g1) at (18.6,6.8) {The system is $PAC(\epsilon, \delta)$-correct};
% Draw edges
\node at (4.211,2.0554) {yes/no};
\node at (1.8227,2.0221) {$Mem(w)$};
\draw [-{>[scale=2]}] (a2) -- (8.9991,1.8) -- (5.3215,1.8) -- (5.3223,0.5556cm);
\draw [-{>[scale=2]}] (3.5,3.2112) -- (3.5,0.5555);
\draw [-{>[scale=2]}] (2.7115,0.5555) -- (2.7115,3.2112);
\node at (8.6111,2.9222) {no,};
\node at (7.056,2.0667) {$s$ is a counterexample};
\draw [-{>[scale=2]}] (b1) edge (b2);
\node at (6.7557,0.2778) {$Equ(C)$};
\draw [-{>[scale=2]}] (b2) edge (b3);
\node at (13,0.2666) {yes};
\draw [-{>[scale=2]}] (b3) -- (16,-1.3) -- (4, -1.3) -- (b1);
\node at (13.5999,-1.0333) {no, $c$ is an counterexample};
\draw [-{>[scale=2]}](b2) -- (10,1.3001) -- (21,1.3001) -- (a4);
\node at (11.0999,1.0112) {no, $Equ(C)$};
\draw [-{>[scale=2]}](a4) -- (a3);
\node at (12.1,4.2557) {yes};
\draw [-{>[scale=2]}](a3) -- (a2);
\node at (18.1666,4.2555) {$S$};
\draw [-{>[scale=2]}](a2) -- (9,5.5333) --(3.8,5.5333) --  (e1);
\node at (8.5777,5.222) {yes};
\draw [-{>[scale=2]}](a3)  -- (15,5.5333) --(18.6,5.5333) -- (g1);
\node at (15.3555,5.2111) {no};
\draw [-{>[scale=2]}](b3) -- (e2);
\node at (19.6318,0.2666) {yes};
\end{tikzpicture}